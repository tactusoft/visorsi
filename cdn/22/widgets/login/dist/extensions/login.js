System.register(["jimu-core","jimu-arcgis"],(function(e,t){var i={},r={};return{setters:[function(e){i.getAppStore=e.getAppStore},function(e){r.MapViewManager=e.MapViewManager}],execute:function(){e((()=>{"use strict";var e={826:e=>{e.exports=r},891:e=>{e.exports=i}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{n.r(o),n.d(o,{default:()=>r});var e=n(891),t=n(826),i=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{a(r.next(e))}catch(e){o(e)}}function d(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,d)}a((r=r.apply(e,t||[])).next())}))};class r{constructor(){this.id="login",this.widgetId="widget_28",this._viewManager=t.MapViewManager.getInstance(),this.isTokenValid=()=>i(this,void 0,void 0,(function*(){const e=localStorage.getItem("myUniqueTokenExpiry");return!!e&&Date.now()<=parseInt(e)}))}process(t){return i(this,void 0,void 0,(function*(){if(window.jimuConfig.isInBuilder)return Promise.resolve(t);if(this._getActiveViewId(this.widgetId,(0,e.getAppStore)().getState().jimuMapViewsInfo),!(yield this.isTokenValid())){const e=this.findWidgetIdByUri(t,"widgets/common/edit/");if(e)return this.removeWidgetFromLayout(t,yield e)}return Promise.resolve(t)}))}_getActiveViewId(e,t){let i=Object.keys(t||{}).find((i=>t[i].mapWidgetId===e&&t[i].isActive));return i||(i=Object.keys(t||{}).find((i=>t[i].mapWidgetId===e))),i}removeWidgetFromLayout(e,t){return i(this,void 0,void 0,(function*(){const i=JSON.parse(JSON.stringify(e)),r=e.widgets.widget_5.layouts.controller.LARGE,n=e.layouts.layout_2.content,o=e.layouts.layout_2.order;localStorage.setItem("contentWidget",JSON.stringify(n)),localStorage.setItem("contentOrder",JSON.stringify(o));const s=Object.entries(n).find((([e,i])=>i.widgetId===t));if(s){const[e]=s;delete n[e],i.layouts[r].order=o.filter((t=>t!==e)),i.layouts[r].content=n}return i}))}findWidgetIdByUri(e,t){return i(this,void 0,void 0,(function*(){for(const i in e.widgets)if(e.widgets.hasOwnProperty(i)&&e.widgets[i].uri===t)return i;return null}))}}})(),o})())}}}));
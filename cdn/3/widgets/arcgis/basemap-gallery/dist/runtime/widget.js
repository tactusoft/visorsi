System.register(["jimu-core","jimu-arcgis","jimu-ui","esri/Basemap","esri/widgets/BasemapGallery","esri/portal/Portal","esri/request","esri/core/reactiveUtils","esri/widgets/BasemapGallery/BasemapGalleryViewModel"],(function(e,t){var r={},n={},i={},o={},a={},u={},s={},l={},c={};return{setters:[function(e){r.MutableStoreManager=e.MutableStoreManager,r.React=e.React,r.ReactRedux=e.ReactRedux,r.classNames=e.classNames,r.css=e.css,r.getAppStore=e.getAppStore,r.jsx=e.jsx,r.portalUrlUtils=e.portalUrlUtils},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent,n.portalUtils=e.portalUtils},function(e){i.WidgetPlaceholder=e.WidgetPlaceholder},function(e){o.default=e.default},function(e){a.default=e.default},function(e){u.default=e.default},function(e){s.default=e.default},function(e){l.default=e.default},function(e){c.default=e.default}],execute:function(){e((()=>{var e={98782:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><g clip-path="url(#a)"><path fill="#000" fill-rule="evenodd" d="M1 1h7v7H1V1ZM0 9V0h9v9H0Zm12-8h7v7h-7V1Zm-1 8V0h9v9h-9Zm-3 3H1v7h7v-7Zm-8-1v9h9v-9H0Zm12 1h7v7h-7v-7Zm-1 8v-9h9v9h-9Z" clip-rule="evenodd"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h20v20H0z"></path></clipPath></defs></svg>'},63673:e=>{"use strict";e.exports=o},135:e=>{"use strict";e.exports=l},69383:e=>{"use strict";e.exports=u},68831:e=>{"use strict";e.exports=s},64946:e=>{"use strict";e.exports=a},37139:e=>{"use strict";e.exports=c},26826:e=>{"use strict";e.exports=n},48891:e=>{"use strict";e.exports=r},30726:e=>{"use strict";e.exports=i}},t={};function d(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,d),i.exports}d.d=(e,t)=>{for(var r in t)d.o(t,r)&&!d.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.p="";var p={};return d.p=window.jimuConfig.baseUrl,(()=>{"use strict";d.r(p),d.d(p,{__set_webpack_public_path__:()=>y,default:()=>g});var e,t=d(48891),r=d(26826),n=d(30726);!function(e){e.Organization="ORGANIZATION",e.Custom="CUSTOM"}(e||(e={}));var i=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}s((n=n.apply(e,t||[])).next())}))};const{useEffect:o,useRef:a}=t.React;var u=d(63673),s=d(64946),l=d(69383),c=d(68831),f=d(135),v=d(37139),m=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}s((n=n.apply(e,t||[])).next())}))};const h=d(98782),g=d=>{const{useMapWidgetIds:p,config:g,id:y,theme:w,token:b,mutableStateProps:x}=d,{basemapsType:R,customBasemaps:M}=g,j=function(e){const t=a();return o((()=>{t.current=e})),t.current}(R),S=t.React.useRef(null);S.current=R;const B=t.React.useRef(null),P=t.React.useRef(null),U=t.React.useRef(null),[G,O]=t.React.useState(!1),C=t.React.useRef(null),_=t.React.useRef({}),I=t.React.useRef({}),N=t.React.useMemo((()=>(null==x?void 0:x.cachedOrgBasemaps)||null),[null==x?void 0:x.cachedOrgBasemaps]),V=t.React.useCallback((e=>{t.MutableStoreManager.getInstance().updateStateValue(y,"cachedOrgBasemaps",e)}),[y]),E=t.React.useMemo((()=>(null==x?void 0:x.cachedBaseMapGallery)||null),[null==x?void 0:x.cachedBaseMapGallery]),A=t.React.useCallback((e=>{t.MutableStoreManager.getInstance().updateStateValue(y,"cachedBaseMapGallery",e)}),[y]);t.React.useEffect((()=>{if(null!==E){const e=E.container;C.current&&0===C.current.childElementCount&&e&&C.current.appendChild(e)}}),[]);const Z=t.ReactRedux.useSelector((e=>{var t,r;const n=null!==(t=e.appStateInBuilder)&&void 0!==t?t:e;return p?null===(r=n.appConfig.widgets[p[0]])||void 0===r?void 0:r.useDataSources:[]}));t.React.useEffect((()=>{if(I.current&&Z)for(const e in I.current)P.current!==e&&(delete I.current[e],_.current[e]&&delete _.current[e])}),[Z]);const T=()=>m(void 0,void 0,void 0,(function*(){if(null!==N)return N;let e=[];const n=(0,t.getAppStore)().getState().portalUrl,o=new l.default({url:n}),a=yield k(o);if(H())return e;const u=yield((e,r,n,o,a=!1)=>i(void 0,void 0,void 0,(function*(){const u=t.portalUrlUtils.getBaseGroupUrl(r),s=n.useVectorBasemaps&&n.vectorBasemapGalleryGroupQuery?n.vectorBasemapGalleryGroupQuery:n.basemapGalleryGroupQuery;return e(u,{query:{f:"json",q:a?'title:"ArcGIS Online Basemaps" AND owner:esri_en':s,token:o},responseType:"json"}).then((e=>Promise.resolve(e.data.results[0])),(()=>i(void 0,void 0,void 0,(function*(){return Promise.reject(null)}))))})))(c.default,n,a,b,!1);if(H())return e;const s=u.id;e=yield((e,n,o,a)=>i(void 0,void 0,void 0,(function*(){const a=" "+r.portalUtils.getItemQueryStringByTypes(["Web Map"])+" ",u="group:"+o+" AND "+a;return e.queryItems({start:1,num:100,f:"json",sortField:"title",sortOrder:"asc",query:u}).then((e=>i(void 0,void 0,void 0,(function*(){const r=((e,r)=>{const n=[];return e.forEach((e=>{const i=t.portalUrlUtils.getItemUrl(r,e.id)+"/info/"+e.thumbnail,o={id:e.id,title:e.title,thumbnailUrl:i,type:e.type};n.push(o)})),n})(e.results,n);return Promise.resolve(r)}))))})))(o,n,s);const d=q(e),p=yield Promise.all(d);return V(p),p})),k=e=>e.load().then((()=>m(void 0,void 0,void 0,(function*(){return Promise.resolve(e.sourceJSON)}))),(()=>m(void 0,void 0,void 0,(function*(){return Promise.reject(null)})))),q=e=>{const t=[];return e.forEach((e=>m(void 0,void 0,void 0,(function*(){const r=(n=e,m(void 0,void 0,void 0,(function*(){const e=new u.default({portalItem:{id:n.id}}),t=yield e.load();return Promise.resolve(t)})));var n;t.push(r)})))),t},W=t=>m(void 0,void 0,void 0,(function*(){if(void 0===j&&null!=E||!t)return void O(!0);O(!1);const r=yield m(void 0,void 0,void 0,(function*(){let t=[];const r=I.current[P.current];if(R===e.Organization)t=yield T();else{const e=q(M);t=yield Promise.all(e)}return!t.some((e=>U.current.basemapEquals(r,e)))&&r&&(t=t.concat(r)),t}));if(H())return void O(!0);null!=E&&E.destroy(),A(null);const n=document&&document.createElement("div");n.className="esri-component h-100",C.current&&(0===C.current.childElementCount?C.current.appendChild(n):C.current.replaceChildren(n)),A(new s.default({view:t,source:r,container:n})),O(!0)}));t.React.useEffect((()=>{if(p&&(null==p?void 0:p.length)<=0)return B.current=null,P.current=null,_.current={},void(null!=E&&(!E.destroyed&&E.destroy(),A(null)));j&&j!==R&&B.current&&B.current.map&&(()=>{for(const e in I.current){const t=I.current[e];_.current[e]=t}})(),W(B.current)}),[p,M,R]),t.React.useEffect((()=>{E&&(_.current&&_.current[P.current]&&(E.viewModel.activeBasemap=_.current[P.current]),f.default.when((()=>E.activeBasemap),(()=>{_.current[P.current]=E.activeBasemap})))}),[E]);const H=()=>R!==S.current;return!p||(null==p?void 0:p.length)<=0?(0,t.jsx)(n.WidgetPlaceholder,{icon:h,widgetId:y,message:d.intl.formatMessage({id:"_widgetLabel",defaultMessage:"Basemap Gallery"})}):(0,t.jsx)("div",{className:"jimu-widget jimu-basemap-widget surface-1 border-0",css:t.css`
    &.jimu-basemap-widget {
      min-width: 240px;
      min-height: 320px;
      .esri-ui-inner-container.esri-ui-corner-container{
        .esri-basemap-gallery.esri-component {
          width:100%;
          background-color: transparent !important;
          .esri-basemap-gallery__item {
            animation: none;
            transition: none;
          }
          .esri-basemap-gallery__item--selected {
            border-color: var(--primary-500);
          }
        }
      }
      .esri-ui-corner .esri-component.esri-widget--panel-height-only {
        max-height: none;
      }
    }
  `},(0,t.jsx)(r.JimuMapViewComponent,{useMapWidgetId:null==p?void 0:p[0],onActiveViewChange:e=>{if(null==e?void 0:e.view){const t=e.id,r=e.view.map;if(B.current=e.view,P.current=t,U.current=new v.default({view:e.view}),t.match(/widget.*?null/g)&&(_.current={}),!I.current[t]){const n=e.view.map.basemap;!n.thumbnailUrl&&(n.thumbnailUrl=r.thumbnailUrl),I.current[t]=n}W(B.current)}else E&&!E.destroyed&&E.destroy()}}),(0,t.jsx)("div",{className:(0,t.classNames)("esri-ui-inner-container","esri-ui-corner-container",{"d-none":!G}),role:"listbox"},(0,t.jsx)("div",{className:"esri-ui-corner w-100 h-100",ref:C})),!G&&(0,t.jsx)("div",{className:"jimu-secondary-loading"}))};function y(e){d.p=e}})(),p})())}}}));